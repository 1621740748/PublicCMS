<!--onsubmit="return iframeCallback(this, $.bringBack)"-->
<form action="cmsImport/upload" id="registSubmit" method="post" enctype="multipart/form-data"
      class="pageForm required-validate">
    <input type="hidden" name="_csrf" value="<@_csrfToken admin=true/>"/>
    <div class="pageFormContent" layouth="50" id="pageFormContent">
        <dl class="nowrap">
            <dt><@t.page 'file'/>:</dt>
            <dd>
                <input type="hidden" name="field" value="${field!'fileName'}"/>
                <input type="hidden" name="originalField" value="${originalField!}"/>
                <input type="file" name="file" class="required" size="30" accept="*"/>
            </dd>
        </dl>

        <textarea id="txtMsg" rows="5" cols="80" readonly="readonly">
        导入结果：
        </textarea>

    </div>

    <div class="formBar">
        <ul>
            <li>
                <button id="id_submit" type="submit" class="buttonActive" onclick="return checkFileType();"><@t.page
                    'upload'/>
                </button>
            </li>
            <li>
                <button type="button" class="button" onclick="$.bringBack({'${field}':''});return false;"><@t.page
                    'button.clear_select'/>
                </button>
            </li>
            <li>
                <button type="button" class="button close"><@t.page 'button.close'/></button>
            </li>
        </ul>
    </div>
</form>
<script>
    $('#registSubmit').on('submit', function () {
        registPost();
        event.preventDefault() //阻止form表单默认提交
    })

    function registPost() {
        $('#registSubmit').ajaxSubmit(function (message) {
            console.log(message);
            $('#txtMsg').html(message.msg + "\n" + message.results);
        })
    }

</script>